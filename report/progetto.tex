\documentclass[a4paper, 11pt]{article}
\usepackage[margin=3cm]{geometry}
\usepackage[]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[italian]{babel}
\usepackage{geometry}
\geometry{a4paper, top=2cm, bottom=3cm, left=1.5cm, right=1.5cm, heightrounded, bindingoffset=5mm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{gensymb}
\usepackage{graphicx}
\usepackage{psfrag,amsmath,amsfonts,verbatim}
\usepackage{xcolor}
\usepackage{color,soul}
\usepackage{fancyhdr}
\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage{newlfont}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{latexsym}
\usepackage{amsthm}
\usepackage{mathtools}
%\usepackage{subfigure}
\usepackage{subcaption}
\usepackage{psfrag}
\usepackage{footnote}
\usepackage{graphics}
\usepackage{color}
\usepackage{hyperref}
\usepackage{tikz}


\usetikzlibrary{snakes}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes,arrows}

	
	\tikzstyle{block} = [draw, fill=white, rectangle, 
	minimum height=3em, minimum width=6em]
	\tikzstyle{sum} = [draw, fill=white, circle, node distance=1cm]
	\tikzstyle{input} = [coordinate]
	\tikzstyle{output} = [coordinate]
	\tikzstyle{pinstyle} = [pin edge={to-,thin,black}]

\newcommand{\courseacronym}{CAT}
\newcommand{\coursename}{Linea Guida Report\\Controlli Automatici - T}
\newcommand{\tipology}{B}
\newcommand{\trace}{1}
\newcommand{\projectname}{Controllo di uno scaldatore elettrico}
\newcommand{\group}{23}
\newcommand{\myalpha}{\dfrac{h_RA_R}{m_Rc_R}}
\newcommand{\mybeta}{\dfrac{1}{m_Rc_R}}
\newcommand{\mygamma}{\dfrac{\dot{m}_A}{m_A}}
\newcommand{\myphi}{\dfrac{h_RA_R}{m_Ac_A}}

%opening
\title{ \vspace{-1in}
		\huge \strut \coursename \strut 
		\\
		\Large  \strut Progetto Tipologia \tipology - Traccia \trace 
		\\
		\Large  \strut \projectname\strut
		\\
		\Large  \strut Gruppo \group\strut
		\vspace{-0.4cm}
}
\author{Nobili Giacomo, Raffoni Federico, Roca Marco}
\date{}

\begin{document}

\maketitle
\vspace{-0.5cm}

Il progetto riguarda il controllo di uno scaldatore elettrico, la cui dinamica viene descritta dalle seguenti equazioni differenziali 
%
\begin{subequations}\label{eq:system}
\begin{align}
	m_Rc_R\frac{dT_R(t)}{dt} &= h_RA_R(T_{out}(t)-T_R(t)) + \frac{P_E(t)}{(1 + \kappa T_R(t))} \\
	m_Ac_A\frac{dT_{out}(t)}{dt} &= \dot{m}_Ac_A(T_{in}-T_{out}(t)) + h_RA_R(T_R(t)-T_{out}(t)),
\end{align}
\end{subequations}
%
dove

\begin{itemize}
	\item $T_R(t)$ è la temperatura del riscaldatore [C°];
	\item $T_{out}(t)$ è la temperatura dell'aria in uscita dal riscaldatore [C°];
	\item $P_E(t)$ è la potenza elettrica fornita [W];
	\item $T_{in}$ è la temperatura dell'aria in ingresso (ambiente a temperatura costante) [C°];
	\item $m_R$ è la massa del riscaldatore [kg];
	\item $c_R$ è il calore specifico del riscaldatore [J/(kg C°)];
	\item $h_R$ è il coefficiente di convezione tra riscaldatore e aria [m²];
	\item $\kappa$ è il coefficiente di variazione della resistenza con la temperatura [1/C°];
	\item $m_A$ è la massa dell'aria [kg];
	\item $c_A$ è il calore specifico dell'aria [J/(kg C°)];
	\item $\dot{m}_A$ è la portata massica dell'aria [kg/s].
\end{itemize}


\section{Espressione del sistema in forma di stato e calcolo del sistema linearizzato intorno ad una coppia di equilibrio}

Innanzitutto, esprimiamo il sistema~\eqref{eq:system} nella seguente forma di stato
%
\begin{subequations}
\begin{align}\label{eq:state_form}
	\dot{x} &= f(x,u)
	\\
	y &= h(x,u).
\end{align}
\end{subequations}
%
Pertanto, andiamo individuare lo stato $x$, l'ingresso $u$ e l'uscita $y$ del sistema come segue 
%
\begin{align*}
	x := \begin{bmatrix}
		T_R
		\\
		T_{out}
	\end{bmatrix}, \quad u := P_E, \quad y := T_{out}
\end{align*}
%
Coerentemente con questa scelta, ricaviamo dal sistema~\eqref{eq:system} la seguente espressione per le funzioni $f$ ed $h$
%
\begin{align*}
	f(x,u) &=  \begin{bmatrix}
		f_1 (x,u)
		\\
		f_2 (x,u)
	\end{bmatrix}  
    := 
    \begin{bmatrix}
		\myalpha x_2 - \myalpha x_1 + \dfrac{u}{(m_Rc_R)(1+\kappa x_1)} \\ \\
		\mygamma T_{in} - (\mygamma + \myphi) x_2 + \myphi x_1
	\end{bmatrix} 
	\\
	h(x,u) &:= x_{2}
\end{align*}
%
Una volta calcolate $f$ ed $h$ esprimiamo~\eqref{eq:system} nella seguente forma di stato
%
\begin{subequations}\label{eq:our_system_state_form}
\begin{align}
	\begin{bmatrix}
		\dot{x}_1
		\\
		\dot{x}_2
	\end{bmatrix} &=
	\begin{bmatrix}
		\myalpha x_2 - \myalpha x_1 + \dfrac{u}{(m_Rc_R)(1+\kappa x_1)} \\ \\
		\mygamma T_{in} - (\mygamma + \myphi) x_2 + \myphi x_1
	\end{bmatrix} 
	\label{eq:state_form_1}
	\\ \\
	y &= x_2
\end{align}
\end{subequations}
%
Per trovare la coppia di equilibrio $(x_e, u_e)$ di~\eqref{eq:our_system_state_form}, andiamo a risolvere il seguente sistema di equazioni
%
\begin{align}
	\begin{cases}
		f_1(x_e, u_e) = 0\\
		f_2(x_e, u_e) = 0
	\end{cases}
	\implies
	\begin{cases}
		\myalpha ( x_{2e} - x_{1e}) + \dfrac{u_e}{(m_Rc_R)(1 + \kappa x_{1e})} = 0\\ \\
		\mygamma T_{in} - (\mygamma + \myphi) x_{2e} + \myphi x_{1e} = 0
	\end{cases}
\end{align}\\
In particolare sono noti gli equilibri per lo stato $(x_{1e}, x_{2e})$ e dobbiamo ricavare $u_e$ in relazione ad essi.
Possiamo ottenere il risultato dalla prima equazione isolando $u_e$. Procedendo con i calcoli otteniamo:\\
\begin{align*}
	u_e = h_RA_R(x_{1e}-x_{2e})(1+\kappa x_{1e})
\end{align*}
%
Infine, sostituendo i parametri, la coppia di equilibrio risulta:
%
\begin{align}
	x_e := \begin{bmatrix}
		200 \text{ °C}\\
		80 \text{ °C}
	\end{bmatrix},  \quad u_e = 756\text{ W}.\label{eq:equilibirum_pair}
\end{align}
%
Definiamo le variabili alle variazioni $\delta x$, $\delta u$ e $\delta y$ come 
%
\begin{align*}
	\delta x \approx x(t) -x_e, 
	\quad
	\delta u \approx u(t) -u_e, 
	\quad
	\delta y \approx y(t) -y_e.
\end{align*}
%
L'evoluzione del sistema espressa nelle variabili alle variazioni pu\`o essere approssimativamente descritta mediante il seguente sistema lineare
%
\begin{subequations}\label{eq:linearized_system}
\begin{align}
	\delta \dot{x} &= A\delta x + B\delta u
	\\
	\delta y &= C\delta x + D\delta u,
\end{align}
\end{subequations}
%
dove le matrici $A$, $B$, $C$ e $D$ vengono calcolate come

%
\renewcommand{\arraystretch}{2}
\begin{subequations}\label{eq:matrices}
\begin{align}
	A &= 
    \begin{bmatrix}
    \left.\dfrac{\partial f_1(x,u)}{\partial x_1}\right|_{x_e,u_e} &
    \left.\dfrac{\partial f_1(x,u)}{\partial x_2}\right|_{x_e,u_e} \\
    \left.\dfrac{\partial f_2(x,u)}{\partial x_1}\right|_{x_e,u_e} &
    \left.\dfrac{\partial f_2(x,u)}{\partial x_2}\right|_{x_e,u_e}
    \end{bmatrix}
    = 
    \begin{bmatrix}
		-(\myalpha + \mybeta \dfrac{u_e\kappa}{(1+\kappa x_{1e})^2}) & \myalpha \\
		\myphi & - \myphi - \mygamma
	\end{bmatrix}\\
    &=
    \begin{bmatrix}
    -1.05 & -0.45 \\
    -0.35 & -0.95
    \end{bmatrix}
	\\ \\
	B &=
    \begin{bmatrix}
    \left.\dfrac{\partial f_1(x,u)}{\partial u}\right|_{x_e,u_e} \\
    \left.\dfrac{\partial f_2(x,u)}{\partial u}\right|_{x_e,u_e}
\end{bmatrix}
    =
    \begin{bmatrix}
		\dfrac{1}{(m_Rc_R)(1+\kappa x_{1e})}\\
		0
	\end{bmatrix}
    =
    \begin{bmatrix}
    2.407\cdot 10^{-5} \\
    0
    \end{bmatrix},
	\\ \\
	C &=
    \begin{bmatrix}
    \left.\dfrac{\partial h(x,u)}{\partial x_1}\right|_{x_e,u_e} &
    \left.\dfrac{\partial h(x,u)}{\partial x_2}\right|_{x_e,u_e}
    \end{bmatrix}
=
\begin{bmatrix}
0 & 1
\end{bmatrix}
	\\ \\
	D &=
    \begin{bmatrix}
    \left.\dfrac{\partial h(x,u)}{\partial u}\right|_{x_e,u_e}
    \end{bmatrix}
    =
    \begin{bmatrix}
    0
    \end{bmatrix}
\end{align}
\end{subequations}
\renewcommand{\arraystretch}{1}
%
\section{Calcolo Funzione di Trasferimento}

In questa sezione, andiamo a calcolare la funzione di trasferimento $G(s)$ dall'ingresso $\delta u$ all'uscita $\delta y$ mediante la seguente formula 
%
%
\begin{align*}
G(s) = C \dfrac{adj(sI-A)}{det(sI-A)}B + D
\end{align*}

Procediamo per passi e calcoliamo prima il determinante di $sI-A$:\\
\begin{align*}
	det(sI-A) = (s + \myalpha + \dfrac{u_e\kappa}{(m_Rc_R)(1+\kappa x_{1e})^2})(s + \mygamma + \myphi) - \dfrac{(h_RA_R)^2}{m_Am_Rc_Ac_R}
\end{align*}\\

poi la matrice aggiunta di $sI - A$. 
Visto che quest'ultima è una matrice $2x2$, vale la seguente:\\

$$ adj\Big(\begin{bmatrix}
	a & b\\
	c & d
\end{bmatrix}\Big) = \begin{bmatrix}
	d & -b\\
	-c & a
\end{bmatrix}$$

e quindi:

$$adj(sI-A) = \begin{bmatrix}
	s + \mygamma + \myphi & \myalpha\\ \\
	\myphi & s + \myalpha \dfrac{u_e\kappa}{(m_Rc_R)(1+\kappa x_{1e})^2}
\end{bmatrix}$$\\

Mettendo tutto insieme abbiamo:\\ 
\begin{align*}
	G(s) = \dfrac{1}{det(sI-A)}
	\begin{bmatrix} 0 & 1 \end{bmatrix}
	\begin{bmatrix}
		s + \mygamma + \myphi & \myalpha\\ \\
	\myphi & s + \myalpha \dfrac{u_e\kappa}{(m_Rc_R)(1+\kappa x_{1e})^2}
	\end{bmatrix}
	\begin{bmatrix}
		\dfrac{1}{(m_Rc_R)(1+\kappa x_{1e})}\\
		0
	\end{bmatrix}
\end{align*}\\
Infine, sostituendo i parametri e svolgendo i calcoli si ottiene la funzione di trasferimento del sistema:
\begin{align}\label{eq:transfer_function}
	\setlength{\fboxsep}{20pt}
	\Aboxed{ G(s) = \dfrac{2.407 \cdot 10^-5}{s^2 + 1.968s + 8.152 \cdot 10^-3} }
\end{align}\\
%
Dunque il sistema linearizzato~\eqref{eq:linearized_system}
è caratterizzato dalla funzione di trasferimento~\eqref{eq:transfer_function}
con \textbf{2 poli} e \textbf{nessuno zero}. I poli (indicati con $p_1$ e $p_2$) sono i seguenti: 
\begin{align*}
	p_1 &= -1.964 \\ 
	p_2 &= -0.0042
\end{align*}\\
In Figura 1 mostriamo il corrispondente diagramma di Bode.\\

\begin{figure}[h]
    \centering
    \includegraphics [width=0.9\textwidth]{../figs/G_diagram.pdf} 
    \caption{Diagramma di Bode del sistema.}
    \label{fig:bode_diagram}
\end{figure}
\section*{Analisi in Frequenza}

Consideriamo la funzione di trasferimento:
\begin{equation}
    G(s) = \frac{2.407 \cdot 10^{-5}}{s^2 + 1.968s + 8.152 \cdot 10^{-3}}
\end{equation}

Per passare al dominio della frequenza, sostituiamo $s$ con $j\omega$:
\begin{equation}
    G(j\omega) = \frac{2.407 \cdot 10^{-5}}{(j\omega)^2 + 1.968(j\omega) + 8.152 \cdot 10^{-3}}
\end{equation}\\
Notiamo che ci troviamo nel caso di un sistema del secondo ordine (due poli a parte reale negativa). Di conseguenza il sistema si comporta come un filtro passa-basso reale. \\
Il guadagno statico si mantiene costante fino a quando la frequenza raggiunge il modulo del polo più vicino all'origine, ovvero $|p_2|=0.0042$ rad/s. A questa frequenza, il polo $p_2$ introduce una pendenza di $-20$ dB/decade nel diagramma delle ampiezze. 
Dopo che anche il secondo polo si manifesta ad $\omega = 1.964$ rad/s avremo una pendenza di $-40$ db/decade.\\
Per quanto riguarda il diagramma della fase, vediamo che presenta due curvature principali, in corrispondenza dei due poli, per poi assestarsi a frequenze alte su $-180$°.\\

Ora portiamo la funzione di trasferimento nella forma di Bode:
\begin{equation}
   G(j\omega) = \frac{0.00295}{1 + 2j(10.9)\frac{\omega}{0.0903} - \frac{\omega^2}{0.0903^2}}
\end{equation}
Confrontiamo il denominatore con la forma canonica $s^2 + 2\xi\omega_n s + \omega_n^2$ per ricavare i parametri caratteristici.
La pulsazione naturale risulta:
   \begin{equation}
       \omega_n = 0.0903 \, \text{rad/s}
    \end{equation}
Il coefficiente di smorzamento risulta:
    \begin{equation}
      \xi = 10.9
    \end{equation}
Essendo $\xi>1$, il sistema è fortemente smorzato e il picco di risonanza non è rilevante.

\section{Mappatura specifiche del regolatore}
\label{sec:specifications}

Le specifiche da soddisfare sono le seguenti:\\ \\
\textbf{Specifica 1:} Errore a regime $|e_\infty| \le e^* = 0.001$ in risposta ad un gradino
$w(t) = W \cdot 1(t)$ e $d(t) = D \cdot 1(t)$ con ampiezze $W \le 50$ e $D \le 2$ \\

Sappiamo che
\begin{align*}
	e_\infty &= \lim_{t \rightarrow \infty} e(t) = \lim_{s \rightarrow 0} sE(s) = \lim_{s \rightarrow 0} sS(s)(\dfrac{W}{s} + \dfrac{D}{s}) = (W + D) \lim_{s \rightarrow 0} S(s)
\end{align*}

Vista l'assenza di poli in $s=0$, il limite di $S(s)$ per $s \rightarrow 0$ vale $\frac{1}{1 + \mu}$, e quindi
\begin{align*}
	e_\infty = \frac{W+D}{1+\mu} \approx \frac{W+D}{\mu} \le e^*
\end{align*} 

e isolando $\mu$
\begin{align*}
	\mu = L(0) \ge \frac{D^* + W^*}{e^*} = 5.2 \cdot 10^4
\end{align*}

Abbiamo quindi ottenuto la prima condizione:
\begin{align*}
	\setlength{\fboxsep}{10pt}
	\Aboxed{\mu \ge 5.2 \cdot 10^4}
\end{align*}
\\
\textbf{Specifica 2:} Margine di fase $M_f \ge 40$° \\ \\
\textbf{Specifica 3:} Sovraelongazione percentuale massima del $18\%$, quindi $S\% \le 18\% $ \\

Sappiamo che $S$ \% $\le S^{\star}$ equivale a richiedere $\xi \ge\xi^{\star}$, con $S^{\star} = e^{\frac{-\pi\xi^{\star}}{\sqrt{1-(\xi^{\star})^2}}}$. Procedendo con i calcoli si ottiene:
\begin{align*}
    \xi^{\star} =0.479133 \approx 0.48
\end{align*} 
Essendo $M_f \ge 100\xi^{\star}$, allora si ottiene la condizione  
\begin{align*}
	\setlength{\fboxsep}{10pt}
	\Aboxed{M_f \ge 48\%}
\end{align*}
La quale, dovendo scegliere la più restrittiva tra la specifica 2 e 3, risulta la condizione da imporre sul margine di fase. 
\\ \\
\textbf{Specifica 4:} Il tempo di assestamento alla $\epsilon\% = 1\%$ deve essere inferiore al valore fissato: $T{a,\epsilon}=0.3s$.\\

Ricordando che $T_{a,1} = 4.6T$ e che $T=\frac{1}{\xi\omega_c}$, allora si ottiene che
\begin{align*}
    \omega_c\ge\frac{460}{T^{\star}M_f^{\star}} \approx 32\text{ rad/s}
\end{align*}
Possiamo concludere che 
\begin{align*}
	\setlength{\fboxsep}{10pt}
	\Aboxed{\omega_{c,min}= 32 {\text{ rad/s}}}
\end{align*}
\\
\textbf{Specifica 5:} Il disturbo sull'uscita $d(t)$, con banda limitata nel range delle pulsazioni $[0, 0.1]$ deve essere abbattuto di almeno 60 dB; ciò equivale a: 
\begin{align*}
    |L(j\omega)|_{\text{dB}} \ge60 {\text{ dB \quad con } \omega\in[\omega_{d,min},\omega_{d,max}]=[0,0.1]}
\end{align*}\\ \\
\textbf{Specifica 6:} Il rumore di misura $n(t)$, con banda limitata nel range delle pulsazioni $[10^3, 10^6]$ deve essere abbattuto di almeno 40 dB; ciò equivale a:
\begin{align*}
    |L(j\omega)|_{\text{dB}} \le-40 {\text{dB\quad con }\omega\in[\omega_{n,min},\omega_{n,max}]=[10^3,10^6]}
\end{align*}
\\ \\
%
Pertanto, in Figura 2 mostriamo il diagramma di Bode della funzione di trasferimento $G(s)$ con le zone proibite emerse dalla mappatura delle specifiche.\\

\begin{figure}[h]
    \centering
    \includegraphics [width=0.9\textwidth]{../figs/mappatura.pdf} 
    \caption{Mappatura delle richieste}
    \label{fig:mappatura}
\end{figure}
Si può notare dal diagramma delle ampiezze che il guadagno statico è insufficiente. E' compito del regolatore alzarlo per soddisfare la specifica 1.
\section{Sintesi del regolatore statico}
\label{sec:static_regulator}

In questa sezione progettiamo il regolatore statico $R_s(s)$ partendo dalle analisi fatte in sezione~\ref{sec:specifications}.\\

La specifica 1 sull'errore a regime impone di avere un guadagno statico pari o superiore a $\mu^{\star}_e=5.2\cdot10^4$. 
Di conseguenza, il guadagno del regolatore statico deve essere tale da imporre un guadagno complessivo almeno pari a $\mu^{\star}_e$. 
Ne consegue che il guadagno di $R_s(s)$ deve essere pari a:
\begin{align*}
    \mu_e= \frac{\mu^{\star}_e}{|G(0)|} = \frac{5.2\cdot10^4}{3\cdot10^{-3}}= 1.7283\cdot10^7
\end{align*}\\

La specifica 5 sul disturbo in uscita impone di avere 
\begin{align*}
    \min_{[\omega_{d,min},\omega_{d,max}]}|L(j\omega)|_{\text{dB}}=|L(\omega_{d,min})|_{\text{dB}}=|G(\omega_{d,min})|_{\text{dB}} \ge60{\text{dB}}=\mu^{\star}_d
\end{align*}
Passando dai decibel a una forma lineare otteniamo:
\begin{align*}
    \mu^{\star}_d=10^{\frac{60}{20}}=10^3
\end{align*}
Di conseguenza, il guadagno del regolatore statico deve essere tale da imporre un guadagno complessivo almeno pari a $\mu^{\star}_d$, che è pari a:
\begin{align*}
    \mu_d= \frac{\mu^{\star}_d}{|G(\omega_{d,min})|} = \frac{10^3}{1.223\cdot10^{-4}}= 8.1767\cdot10^6
\end{align*}\\

In definitiva, dobbiamo imporre che il guadagno statico di $R_s(s)$ sia:
\begin{align*}
    \mu= \max\{\mu_e, \mu_d\} = \mu_e=1.7283\cdot10^7
\end{align*}\\
Non dovendo soddisfare altri requisiti, termina qui il progetto del regolatore statico, la cui espressione è semplicemente:
\begin{align*}
    \setlength{\fboxsep}{10pt}
    \Aboxed{R_s(s)=\mu}
\end{align*}\\

Dunque, definiamo la funzione estesa $G_e(s) = R_s(s)G(s)$ e, in Figura 3, mostriamo il suo diagramma di Bode per verificare se e quali zone proibite vengono attraversate.\\
\begin{figure}[h]
    \centering
    %\includegraphics [width=0.3\textwidth]{../figs/G_estesa.pdf} 
    \caption{Funzione di trasferimento estesa}
    \label{fig:mappatura}
\end{figure}
\\Dalla Figura 3, emerge che nel diagramma di ampiezza la funzione estesa interseca la zona proibita corrispondente alla specifica 4 sulla frequenza critica minima, ossia la frequenza di attraversamento a $0$ dB è inferiore a $\omega_{c,min}$.\\
Inoltre possiamo notare dal diagramma di fase che nell'intervallo di pulsazioni ammissibili per la pulsazione di attraversamento $\omega_c$ non esistono pulsazioni in cui la fase rispetta il vincolo sul margine di fase, relativo alle specifiche 2 e 3.

\section{Sintesi del regolatore dinamico}

In questa sezione, progettiamo il regolatore dinamico $R_d(s)$.\\
Dalle analisi fatte in Sezione~\ref{sec:static_regulator}, notiamo di essere nello Scenario di tipo B. Dunque, progettiamo $R_d(s)$ riccorrendo a una rete anticipatrice, ossia una rete nella forma:
\begin{align*}
    R_d(s) =\frac{1+\tau s}{1+\alpha\tau s}\qquad0<\alpha<1
\end{align*}\\
In particolare, applichiamo le formule di inversione per ottenere i parametri $\tau$ e $\alpha\tau$, imponendo la frequenza di attraversamento come $\omega_c^{\star}=70\space$ rad/s. Inoltre, inseriamo un margine di sicurezza per la fase $\varepsilon=8$. Chiamiamo $M^{\star}>1$ l'amplificazione della rete anticipatrice a $\omega_c^{\star}$ e $0<\varphi^{\star}<\frac{\pi}{2}$ lo sfasasmento a tale pulsazione. Allora bisogna che sia:
\begin{align*}
    M^{\star} =\frac{1}{|G_e(j\omega_c^{\star})|}\qquad\varphi^{\star}=M_f^{\star}-[180\degree+\arg\{G_e(j\omega_c^{\star})\}]+\varepsilon
\end{align*}\\
Quindi, tramite le formule di inversione:
\begin{align*}
    \tau =\frac{M^{\star}-\cos\varphi^{\star}}{\omega_c^{\star}\sin\varphi^{\star}}=0.197 \qquad \alpha\tau =\frac{\cos\varphi^{\star}-\frac{1}{M^{\star}}}{\omega_c^{\star}\sin\varphi^{\star}}=8.8\cdot10^{-3}
\end{align*}\\
In Figura 4 mostriamo il diagramma di Bode della funzione d'anello $L(s) = R_d(s) G_e(s)$.

\begin{figure}[h]
    \centering
    \includegraphics [width=0.9\textwidth]{../figs/L_anello.pdf} 
    \caption{Funzione d'anello $L(s)$}
    \label{fig:mappatura}
\end{figure}
Possiamo notare che tutte le specifiche sono rispettate e di conseguenza una rete anticipatrice è sufficiente per il progetto del regolatore dinamico.
\section{Test sul sistema linearizzato}

In questa sezione, testiamo l'efficacia del controllore progettato sul sistema linearizzato con \dots

In Figura \dots, mostriamo lo schema a blocchi del sistema in anello chiuso. \dots

\begin{figure}[h]
    \centering
    \fbox{\parbox{0.35\textwidth}{\vspace{1.9cm} Placeholder \vspace{1.9cm}}}
    \caption{Caption.}
    \label{fig:bode_diagram_L}
\end{figure}

\dots

Di seguito è riportato \dots in merito alla risposta del sistema a fronte di un ingresso \dots

\begin{figure}[h]
    \centering
    \fbox{\parbox{0.35\textwidth}{\vspace{1.9cm} Placeholder \vspace{1.9cm}}}
    \caption{Caption.}
    \label{fig:bode_diagram_L}
\end{figure}

\dots
Si nota che \dots

\dots

Inoltre possiamo notare dalle seguenti figure \dots che i disturbi \dots 

\begin{figure}[h]
    \centering
    \fbox{\parbox{0.35\textwidth}{\vspace{1.9cm} Placeholder \vspace{1.9cm}}}
    \caption{Caption.}
    \label{fig:bode_diagram_L}
\end{figure}

In seguito, \dots

\dots

\dots

\dots

\section{Test sul sistema non lineare}

In questa sezione, testiamo l'efficacia del controllore progettato sul modello non lineare con \dots \\

In Figura \dots, mostriamo lo schema a blocchi del sistema in anello chiuso. \dots

\begin{figure}[h]
    \centering
    \fbox{\parbox{0.35\textwidth}{\vspace{1.9cm} Placeholder \vspace{1.9cm}}}
    \caption{Caption.}
    \label{fig:bode_diagram_L}
\end{figure}

\dots

Di seguito è riportato \dots in merito alla risposta del sistema a fronte di un ingresso \dots

\begin{figure}[h]
    \centering
    \fbox{\parbox{0.35\textwidth}{\vspace{1.9cm} Placeholder \vspace{1.9cm}}}
    \caption{Caption.}
    \label{fig:bode_diagram_L}
\end{figure}

\dots
Si nota che \dots\\

\dots

Rispetto alle simulazioni riguardanti il sistema linearizzato emerge \dots\\

\dots

Inoltre, è possibile osservare \dots\\

\dots

\dots

\dots


\section{Punti opzionali}

\subsection{Primo punto}

\dots 

\subsection{Secondo punto}

\dots

\subsection{Terzo punto}

\dots

\section{Conclusioni}

\dots

\end{document}